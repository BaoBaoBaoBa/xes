/**
 * 
 * @authors Your Name (you@example.org)
 * @date    2013-09-03 04:15:14
 * @version $Id$
 */

/*
     * method : stringify(obj);
     * return : json string
     * source : https://gist.github.com/754454
*/
xue.json = xue.json || {};

xue.json.stringify = function (obj) {
    //如果是IE8+ 浏览器(ff,chrome,safari都支持JSON对象)，使用JSON.stringify()来序列化
    if (window.JSON) {
        return JSON.stringify(obj);
    }
    var t = typeof (obj);
    if (t != "object" || obj === null) {
        // simple data type
        if (t == "string") obj = '"' + obj + '"';
        return String(obj);
    } else {
        // recurse array or object
        var n, v, json = [], arr = (obj && obj.constructor == Array);

        // fix.
        var self = arguments.callee;

        for (n in obj) {
            v = obj[n];
            t = typeof(v);
            if (obj.hasOwnProperty(n)) {
                if (t == "string") v = '"' + v + '"'; else if (t == "object" && v !== null)
                    // v = jQuery.stringify(v);
                    v = self(v);
                json.push((arr ? "" : '"' + n + '":') + String(v));
            }
        }
        return (arr ? "[" : "{") + String(json) + (arr ? "]" : "}");
    }
};
/*
    * method : parse(json string)
    * return : js原生值
*/   
xue.json.parse = function (jsonString) {
    if (window.JSON) {
        return window.JSON.parse(s);
    }
    //使用到了jquery的parseJSON(s)方法
    return $.parseJSON(jsonString);
}; 
 
//示例：
// var gather = {
//     id : 1314,
//     name : 'pom',
//     infor : {
//         age : 20,
//         sex : 'man',
//         marry : false,
//         identity : 622421,
//         habit : ['篮球','台球','乒乓球','游戏',true]
//     },
//     family : ['妈妈','爸爸','弟弟'],
//     likeGames : ['PCgame','Netgame'],
// };
// //序列化json数据的方法
// var originalJsonText = JSON.stringify(gather,null,4);
// var customJJsonText = stringify(gather);

// console.log(originalJsonText);
// console.log(customJJsonText);

// //json数据解析为js原生值(Object,Array,String...)的方法
// var evalObj = eval('(' + customJJsonText + ')');
// var originalObj = JSON.parse(customJJsonText);
// var jqueryObj = $.parseJSON(customJJsonText);

// console.log(evalObj);
// console.log(originalObj);
// console.log(jqueryObj);