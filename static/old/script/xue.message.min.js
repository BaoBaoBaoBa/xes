/**
 * XESUI 
 * Copyright 2013 xueersi.com All rights reserved.
 *
 * @description 
 *
 * @author Marco (marco@xesui.com)
 * @modify 2013-07-08 17:01:57
 * @version $Id$
 * 
 * @links http://xesui.com
 */


/**
 * @name ui.message.js
 * @description 信息
 * 
 * @module 
 * @submodule 
 * @main 
 * @class 
 * @constructor 
 * @static 
 */

xue.message = xue.message || {};

(function(){
    var m = xue.message;

    /**
     * 激活当前类别的信息
     * @param  {[type]} type [description]
     * @return {[type]}      [description]
     */
    m.setCurrent = function( type ){
        var tp = type || 1;
        
        var box = $('#nav_tab'), list= box.find('li');
        var act = box.find('li[data-type="' + tp + '"]');
        if(act.length == 0){ return false; }

        // 让对应类别进行一次模拟点击
        act.click();

        // m.clearNewTips( tp );
    };

    /**
     * 清除新消息提示
     * @param  {[type]} type [description]
     * @return {[type]}      [description]
     */
    m.clearNewTips = function( type ){
        var tp = type || 1;
        var top = $('#header .ui_topbar_pop .msg_tips li[data-type=' + tp + ']'), 
            pop = $('#header .layer_news_tips .msg_tips li[data-type=' + tp + ']'), 
            nav = $('#nav_tab li[data-type="' + tp + '"]');
        // 清除顶部下拉列表里面的数字
        if(top.length > 0){
            top.find('a strong').remove();
        }
        // 清除顶部悬浮新消息里面的内容
        if(pop.length > 0){
            var wrap = pop.parents('.layer_news_tips');
            pop.remove();
            if(wrap.find('li').length == 0){
                wrap.remove();
            }
        }
        // 清除我的通知页面里 通知类别上的小红点
        if(nav.length > 0){
            nav.find('em.icon_new').remove();
        }

        // 当全部新消息为空的时候，清除新消息的小圆点；
        var top_new_icon = $('em.icon_messages').parent().find('em.icon_new'),
            top_new = $('.ui_topbar_pop strong');

        if(top_new.length == 0){
            top_new_icon.remove();
            $('#header .loginbar .tips').children('p').find('em.icon_new').remove();
        }
    };

})();